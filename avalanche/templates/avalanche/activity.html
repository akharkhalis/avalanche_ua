{% extends "avalanche/base.html" %}
{% load static from staticfiles %}
{% block meta_title %} - Avalanche Activity{% endblock meta_title %}
{% block title %}Лавинна активність{% endblock title %}
{% block content %}

            <div class="row">
                <div class="col-xs-8">
                    <div id="map-canvas"></div>
                </div>
            
                <div class="col-xs-4" >
   
                        <ul style="padding-left: 0px; margin-top: 10px;">    
                            <li class="list-group-item">24 години: <a href="#">0 лавин</a></li>
                            <li class="list-group-item">48 години: <a href="#">0 лавин</a></li>
                            <li class="list-group-item">7 днів: <a href="#">0 лавин</a></li>
                            <li class="list-group-item">14 днів: <a href="#">0 лавин</a></li>
                            <li class="list-group-item">Місяць: <a href="#">63 лавин</a></li>
                            <li class="list-group-item">Поточний сезон(14/15): <a href="#">351 лавин</a></li> 
                            <li class="list-group-item">Попередній сезон(13/14): <a href="#">351 лавин</a></li> 
                            <li class="list-group-item">Вся історія(з 1983): <a href="#">351 лавин</a></li>                           
                        </ul>
                    </div>    
                </div>
            </div>
<!--Activity Table-->
        <div class="row" id="act_tabl">
            <table class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th># </th>
                                <th>Дата</th>
                                <th>Район</th>
                                <th>Координати</th>
                                <th>Напрямленість</th>
                                <th>Тип</th>
                                <th>Причина(потерпілі)</th>
                                <th></th>
                            </tr>
                        <thead>
                        <tbody>
                            {% for activity in activity %}
                            <tr>
                                <td>{{activity.id}}</td>
                                <td>{{activity.date}} , {{activity.time}} </td>
                                <td>{{activity.location_title}}</td>
                                <td>{{activity.coordinat_x}}, {{activity.coordinat_y}}</td>
                                <td>{{activity.aspect}}</td>
                                <td>{{activity.a_type}}</td>
                                <td>{{activity.triger}}({{activity.victims}})</td>
                                <td><a href="#">більше...</a></td>
                            </tr>
                            {%endfor%}
                        </tbody>
                    </table>
   {% endblock content %}     

<!--JavaScripts-->
       {% block extra_js %}
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>

                    <script>
                        
                        function initialize() {
                          var mapOptions = {
                            zoom: 8,
                            center: new google.maps.LatLng(48.4119842,24.0316965)
                          }
                          var map = new google.maps.Map(document.getElementById('map-canvas'),
                                                        mapOptions);

                          setMarkers(map, beaches);
                        }

                        /**
                         * Data for the markers consisting of a name, a LatLng and a zIndex for
                         * the order in which these markers should display on top of each
                         * other.
                         */
                        var beaches = [
                                {% for activity in activity %}
                                ['{{activity.date}},{{activity.time}} ', {{activity.coordinat_x}}, {{activity.coordinat_y}}, {{activity.id}}],
                                {%endfor%}
                        ];

                        function setMarkers(map, locations) {
                          // Add markers to the map

                          // Marker sizes are expressed as a Size of X,Y
                          // where the origin of the image (0,0) is located
                          // in the top left of the image.

                          // Origins, anchor positions and coordinates of the marker
                          // increase in the X direction to the right and in
                          // the Y direction down.
                          var image2 = {
                            url: '{{PORTAL_URL}} {% static "img/red_point.png"%}',
                            // This marker is 20 pixels wide by 32 pixels tall.
                            size: new google.maps.Size(10, 10),
                            // The origin for this image is 0,0.
                            origin: new google.maps.Point(0,0),
                            // The anchor for this image is the base of the flagpole at 0,32.
                            anchor: new google.maps.Point(0,5)
                          };
                                                     // Shapes define the clickable region of the icon.
                          // The type defines an HTML &lt;area&gt; element 'poly' which
                          // traces out a polygon as a series of X,Y points. The final
                          // coordinate closes the poly by connecting to the first
                          // coordinate.
                          var shape = {
                              coords: [1, 1, 1, 20, 18, 20, 18 , 1],
                              type: 'poly'
                          };
                          for (var i = 0; i < locations.length; i++) {
                            var beach = locations[i];
                            var myLatLng = new google.maps.LatLng(beach[1], beach[2]);
                            var marker = new google.maps.Marker({
                                position: myLatLng,
                                map: map,
                                icon: image2,
                                shape: shape,
                                title: beach[0],
                                zIndex: beach[3]
                            });
                          }

                       }

                        google.maps.event.addDomListener(window, 'load', initialize);

    </script>        
        {% endblock extra_js %}            
